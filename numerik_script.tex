\documentclass[ngerman,fontsize=11pt, paper=a4, parskip=half, titlepage=true, toc=bib]{scrbook}
%	parskip: 	false sets to 1em
%	titlepage:	titlepage (true) or titlehead (false)
%	toc:		table of contents options
% 
% ESSENTIAL PACKAGES
% ---------------------------------------------------------------------------
%% encodings
\usepackage[T1]{fontenc}      %font-encoding WITH e.g. ö (default is OT1 with 7- instead of 8-bit)
\usepackage[utf8]{inputenc}   %input-encoding WITH e.g. ö (depends on system), better after fontenc
% ..................................................
%% language
\usepackage{babel}	       %rules typical for chosen language(s)
% ..................................................
%% font-settings
\usepackage{lmodern}	       %font: latin modern
\usepackage{microtype}	       %micro-typographic optimizing, e.g. ligatures
% 
% EXTRA PACKAGES
% ----------------------------------------------------------------------------
%% pagestyle
\usepackage{scrpage2}		%KOMA pagestyles scrheadings, scrplain
% \usepackage{enumitem}		% numeration items like \alpha*)
\usepackage{enumerate}		% easy numeration
% ..................................................
%% quotes
\usepackage{csquotes}		%easy quotes with \enquote{...}
% ..................................................
%% maths
\usepackage{amsmath}		%improves maths-sections
\usepackage{mathtools}          %provides tools like \DeclareParedDelimiter or \DefineMathOperator
\usepackage{amsthm}		%for proofs etc.
\usepackage{amssymb}		%further maths symbols like \square for proofs
\usepackage{dsfont}		%for \mathds{letter} to create e.g. the rational numbers symbol Q
\usepackage{stmaryrd}		%for math symbols like lightning bold
\usepackage{MnSymbol}
% \usepackage{bm}		% nicer bold math symbols with \boldsymbol
% \usepackage{siunitx}		%units
% ..................................................
%% colors
% \usepackage{color}		%to set/define colors,
% predefined: white , black, red, green, blue, cyan, magenta, yellow
% ..................................................
%% objects
\usepackage{wrapfig,graphicx}	%inclusion of graphics with \includegraphics{name}
\usepackage{tikz,pgf}
\usetikzlibrary{arrows}
\usetikzlibrary{matrix}
\usetikzlibrary{decorations.pathmorphing}
\usepackage{framed}
% ..................................................
%% index/bibliography
\usepackage{makeidx}		%create an index with \makeindex in head
% (creates *.idx file)
\makeindex			%if index is required (after {makeidx})
\usepackage[backend=biber,style=alphabetic]{biblatex}	% print bibliography with \printbibliography
\bibliography{numerik_script.bib} % loads .bib-file for
% biber-bibliography; after {biblatex}
% ..................................................
%% (nicer)tables
\usepackage{booktabs} 		%enables better spacing and lines in tables
% \usepackage{multirow}	%option multirow for tables (centers text vertically)
% \usepackage{tabulary}	%table-width matches content
% ..................................................
%% font
\usepackage{ulem}         % strike text out
% ..................................................
%% hyperlinks
\usepackage{hyperref}	%for links/hyperlinks, better load last!
% options: colorlink=true (-> no boxes but colored hyperlinks), color of all link
% ..................................................
%% fonts
% \usepackage{anyfontsize}	%any fontsize with \fontsize{size}{baselineskip}\selectfont
\usepackage{tabularx}  %table with extendable X-column

% DEFINITIONS
% ------------------------------------------------------------------------------------------------
% math (theorems)
\theoremstyle{definition}
\newtheorem{Def}{Definition}[section]		%definition with \begin{Def}
\newtheorem{Bsp}[Def]{Beispiel}
% \theoremstyle{remark}
\newtheorem{Bem}[Def]{Bemerkung}	%corollary with \begin{Korr}
\newtheorem{Wdh}[Def]{Wiederholung}
\theoremstyle{plain}
\newtheorem{Satz}[Def]{Satz}		%theorem with \begin{Satz}
\newtheorem*{satz}{Satz}
\newtheorem{Lem}[Def]{Lemma}		%lemma with \begin{Lem}
\newtheorem{Kor}[Def]{Korollar}		%theorem with \begin{Satz}
\newtheorem{Fol}[Def]{Folgerung}
% \newtheorem{Ax}[Def]{Axiom}		%axiom with \begin{Ax}
% \newtheorem{Prop}[Def]{Proposition}%proposition with \begin{Prop}

% colors
% \definecolor{ashgrey}{rgb}{0.7, 0.75, 0.71}

% NEW COMMANDS
% ------------------------------------------------------------------------------------------------
% symbols
\newcommand{\R}{\mathds{R}}
\newcommand{\Ren}{\mathds{R}^{n}}
\newcommand{\Renn}{\mathds{R}^{n\times n}}
\newcommand{\Renm}{\mathds{R}^{n\times m}}
\newcommand{\Q}{\mathds{Q}}
\newcommand{\N}{\mathds{N}}
\newcommand{\Z}{\mathds{Z}}
\newcommand{\F}{\mathds{F}}
\newcommand{\K}{\mathcal{K}}

% for the three boxes to show float numbers
\newcommand{\floatbox}[3]{ %
  \begin{array}{|c|c|c|}
    \cline{1-3} 	
    #1 & #2 & #3\\
    \cline{1-3}
  \end{array}
}

\newcommand{\nn}[1]{\left\| #1 \right\|}	% norm
\newcommand{\scp}[2]{\langle #1, #2 \rangle}	% scalar prod. 

% inserted sections a), b)
\newcommand{\extrasection}[2]{\vspace{1.5eM}\minisec{\Large\itshape \thesection #1 #2}\vspace{1eM}}

% EVIL HACKS to go along with numeration
% equation numeration
\newcommand{\sectione}[1]{ \setcounter{equation}{0}\section{#1}}
% theorem numeration
\newcommand{\subsectione}[1]{\addtocounter{Def}{1}\subsection{#1}}
\newenvironment{Satze}[1][]{ %
  \begin{Satz}[#1]  }
  { \end{Satz}
  \addtocounter{subsection}{1}}
\newenvironment{Leme}[1][]{ %
  \begin{Lem}[#1] }
  {\end{Lem}
  \addtocounter{subsection}{1}}
\newenvironment{Kore}[1][]{ %
  \begin{Kor}[#1]}
  {\end{Kor}
  \addtocounter{subsection}{1}}
\newenvironment{Fole}[1][]{ %
  \begin{Fol}[#1]}
  {\end{Fol}
  \addtocounter{subsection}{1}}
\newenvironment{Bspe}[1][]{ %
  \begin{Bsp}[#1]}
  {\end{Bsp}
  \addtocounter{subsection}{1}}
\newenvironment{Beme}[1][]{ %
  \begin{Bem}[#1]}
  {\end{Bem}
  \addtocounter{subsection}{1}}
\newenvironment{Defe}[1][]{ %
  \begin{Def}[#1]}
  {\end{Def}
  \addtocounter{subsection}{1}}
\newenvironment{Wdhe}[1][]{ %
  \begin{Wdh}[#1]}
  {\end{Wdh}
  \addtocounter{subsection}{1}}

% Pseudocode
\newenvironment{pseudocode}[1]{ %
  \begin{minipage}{#1}
    \begin{framed}
      \hspace*{1em}	
      \begin{minipage}{#1}
        \begin{tabbing}
          for~~\= for~~\= for~~\= for~~\= some really really large amount of text \= \kill
	}
	{ %
        \end{tabbing}
      \end{minipage}
      \hspace*{1em}
    \end{framed}
  \end{minipage}
}

% missing images
\newcommand{\imagemissing}[1]{
  \begin{center}~\\
    \centering 
    \includegraphics[width=2cm]{images/image_missing.jpg}\\
    \textit{#1} \\
  \end{center}
}	


% STYLE SETTINGS
% ------------------------------------------------------------------------------------------------
% \pagestyle{scrplain}				%set pagestyle to scrheadings or scrplain (instead of headings or plain)
% \clearscrplain						%clear old style (either scrplain odr scrheadings)
% \cfoot[<text for scrplain>]{<text for scrheadings>}	%any new settings for foots/ headings
% \allowdisplaybreaks              %allow multipage for equations
\renewcommand{\theequation}{\thesection.\arabic{equation}}


% quicken compilation
%\includeonly{chapters/numerik_chap0}


% **************************************************************************
\begin{document}

% ----------------------------------------------------------------------------
% FRONTMATTER
% ----------------------------------------------------------------------------
\frontmatter	%for book only, part for title etc.

% TITLE(PAGE)
%	\titlehead{titlehead (free)}
\title{Skript Numerik I}
\subtitle{von Prof. Dr. Luise Blank im WS14/15}
%	\subject{type}
\author{Gesina Schwalbe}
%	\date{date}
%	\extratitle{Schmutztitel}
%	\dedication{Widmung}
%	\thanks{Fußnote}
\maketitle

% ---------------------------------------------------
\tableofcontents

% ----------------------------------------------------------------------------------------------
% CONTENT
% ----------------------------------------------------------------------------------------------
\mainmatter		% part for content

% Kap. 0: Vorwort
\include{chapters/numerik_chap0}

% Kap. 1: Einführung
\include{chapters/numerik_chap1}

% Kap. 2: Lineare Gleichungssysteme: Direkte Methoden
\include{chapters/numerik_chap2}

% Kap. 3: Fehleranalyse
\include{chapters/numerik_chap3}

% Kap. 4: Lineare Gleichungssysteme: Direkte Methoden (Fortsetzung)
\include{chapters/numerik_chap4}

% Kap. 5: Numerische Lösung nichtlinearer Gleichungssysteme
\include{chapters/numerik_chap5}

% Kap. 6: Interpolation
\include{chapters/numerik_chap6}


\chapter{Numerische Integration/Quadratur}

\sectione{Einführung und einfache Quadraturformeln}
Häufig sind Integrale
\begin{gather*}
  I(f) \coloneqq \int_a^bf(t)dt
\end{gather*}
nicht analytisch zu berechnen
oder die benötigte analytische Darstellung
des unbestimmten Integrals ist kompliziert.
Ziel ist $I(f)$ durch eine 
\textbf{Numerische Quadratur}\index{Numerische Quadratur}
\begin{gather*}
  \hat{I}(f)
\end{gather*}
zu approximieren.

Der Begriff numerische Integration ist allgemeiner und
beschreibt das numerische Lösen von
\begin{gather*}
  y'(t) = f\big(t,y(t)\big) \qquad \text{mit } y(a)=c
\end{gather*}
Die numersiche Quadratur $\hat{I}(f)$ sollte
\begin{enumerate}[a)]
  \item effizient ausführbar sein,
  \item viele Eigenschaften der Integration beibehalten und
  \item $I(f)$ gut approximieren.
\end{enumerate}
Zu c) einige Eigenschaften des Riemann-Integrals:\\
Seien $f,g\in C([a,b])$, dann ist $I:C([a,b])\longrightarrow\R$
eine positive Linearform, d.h. $I$ ist linear und 
\begin{gather}
f\geq 0 \quad \Rightarrow \quad I(f)\geq 0
\label{VII.1.1}
\end{gather}
Weiterhin gilt
\begin{gather}
  \int_a^b f(t)dt + \int_b^c f(t)dt = \int_a^cf(t)dt
  \label{VII.1.2}
\end{gather}
Diese sollen nun möglichst beibehalten werden.

\begin{Defe}\label{7.1.1}
Ein Verfahren heißt konvergent von der Ordnung $p$
(hat die Konvergenzordnung $p$),
falls der Fehler (hier $|I(f)-\hat{I}(f)|$)
mit $\mathcal{O}(h^p)$ gegen Null geht für $h\longrightarrow 0$.
\end{Defe}

\subsectione{Mittelpunktregel}
\imagemissing{Veranschaulichung der Mittelpunktregel}\label{im7.1.2}
Zerlege $[a,b]$ in Teilintervalle $[x_i,x_{i+1}]$
für $i=0,\dots,n-1$ der Länge $h_i=x_{i+1}-x_i$, d.h.
\begin{gather*}
  a=x_0 < x_1 < \dots < x_n = b
\end{gather*}
und setze zur Approximation von $I(f)$
\begin{gather}
  \hat{I}_M(f) \coloneqq \sum_{i=0}^{n-1}f\left(
    \frac{x_{i+1}+x_i}{2}
  \right)
  \cdot (x_{i+1}-x_i)
  \label{VII.1.3}
\end{gather}
Für ein äquidistantes Gitter ergibt sich mit $h=\frac{b-a}{n}$
\begin{gather}
  \hat{I}_M(f)= h \sum_{i=0}^{n-1}f\left(
    x_{i}+\frac{h}{2}
  \right)
  \label{VII.1.4}
\end{gather}
Die \textbf{Fehlerschranke}\index{Fehlerschranke}
(Konvergenzordnung) für $f\in C^2([a,b])$
\begin{gather}
  \left| I(f) -\hat{I}_M(f)\right|
  \leq \frac{h^2}{24}(b-a)\nn{f''}_\infty
  \label{VII.1.5}
\end{gather}
ergibt sich aus der Taylorentwicklung
\begin{gather*}
  f(t) = f\left(x_i+\frac{h}{2}\right)
  + f'\left(x_i+\frac{h}{2}\right) \cdot 
  \left(t-\left(x_i+\frac{h}{2}\right)\right)
  + \frac{1}{2}f''\big(\xi_i(t)\big)\cdot
\left(t-\left(x_i+\frac{h}{2}\right)\right)^2
\end{gather*}
mit einer Zwischenstelle $\xi_i(t)$ zwischen $t$ und
$\left(x_i+\frac{h}{2}\right)$, denn
\begin{align*}
  \left|I(f)-\hat{I}_M(f)\right|
  &\leq \sum_{i=0}^{n-1} \left|
    \int_{x_i}^{x_{i+1}}f(t)dt - h\cdot f\left(x_i+\frac{h}{2}\right)
    \right|\\
  &=\left|
    \int_{x_i}^{x_{i+1}}\left( 
    f(t) - f\left(x_i+\frac{h}{2}\right)
    \right) dt
    \right|
\intertext{da $\int_{x_i}^{x_{i+1}}\left(t-\left(x_i+\frac{h}{2}\right)\right)dt=0$}
  &= \sum_{i=0}^{n-1} \left|
    \int_{x_i}^{x_{i+1}}
    \frac{1}{2} f''\big(\xi_i(t)\big)
    \cdot \left(t-\left(x_i+\frac{h}{2}\right)\right)^2dt
    \right|\\
  &\leq \nn{f''}_\infty \cdot \frac{1}{2}
    \sum_{i=0}^{n-1}
    \int_{x_i}^{x_{i+1}}
    \left(t-\left(x_i+\frac{h}{2}\right)\right)^2dt\\
  &=\frac{h^2}{24} (b-a)\nn{f''}_\infty
\end{align*}
Für andere Interpolationspunkte als den Mittelpunkt 
(z.B. einer der Eckpunkt) wird $\mathcal{O}(h^2)$, d.h. 
die Ordnung $2$, nicht erreicht.

\subsectione{Trapezsumme}\index{Trapezregel}
Interpoliere stückweise linear
\imagemissing{Veranschaulichung Trapezsumme}\label{im7.1.3}
\begin{align}\nonumber
  &(x_{i+1}-x_i)\cdot \frac{f(x_i)+f(x_{i+1})}{2} 
    &\text{(Trapezregel)}\\
  \Rightarrow\quad
  & \hat{I}_T(f) = \frac{1}{2}\sum_{i=0}^{n-1}
    \big(
    f(x_i)-f(x_{i+1})
    \big)
    \cdot (x_{i+1}-x_i)
    \label{VII.1.6}
\end{align}
und für äquidistante Gitter ergibt sich die \textbf{Trapezsumme}
\begin{gather}
\hat{I}_T(f) = h\cdot\left( \frac{1}{2}f(x_0)
  +\sum_{i=0}^{n-1}f(x_i)
  +\frac{1}{2} f(x_n)
\right)
\label{VII.1.7}
\end{gather}
Die Konvergenz folgt durch die Riemannschen Unter- bzw. Obersummen
$R_u^{(k)}(f)$ und $R_o^{(k)}(f)$ wegen
\begin{gather*}
  I(f)\longleftarrow R_u^{(k)}(f)
  \leq \hat{I}_T(f)
  \leq R_o^{(k)}(f)\longrightarrow I(f)
  \qquad \text{für } h\longrightarrow 0
\end{gather*}
Später zeigen wir noch die Konvergenzordnung für $f\in C^2([a,b])$
\begin{gather}
  \left| I(f)-\hat{I}_T(f)\right| \leq \frac{h^2}{24}(b-a)\nn{f''}_\infty
  \label{VII.1.8}
\end{gather}
Offensichtlich erfüllen $\hat{I}_M(f)$ und $\hat{I}_T(f)$
die Eigenschaften aus \ref{7.1.1}.
Weiterhin sind sie für lineare Funktionen exakt,
d.h. berechnen die genauen Integralwerte.


\sectione{Interpolatorische Integrationsformeln}
\index{Integrationsformel!interpolatorische/Newton-Cotes-Formeln}
(auch Newton-Cotes-Formeln)\\
Die Idee ist nun, $f$ auf $[a,b]$ polynomial zu interpolieren
an verschiedenen Stellen $a\leq x_0\leq x_1\leq \dots\leq x_n<b$
und dann das Integral zu berechnen, d.h.
\begin{align}\nonumber
  \hat{I}(f) &\coloneqq I\big( p(f\,|\,x_0,\dots, x_n)\big)\\\nonumber
             &=\sum_{i=0}^{n}f(x_i)
               \cdot \int_a^bL_i(t)dt\\
             &=\sum_{i=0}^{n} w_if(x_i)
\label{VII.2.1}
\end{align}
mit den Gewichten 
\begin{gather}
  w_i\coloneqq \int_a^bL_i(t)dt\, .
  \label{VII.2.2}
\end{gather}
Offensichtlich sind diese Quadraturformeln exakt
für Polynome vom Grad weniger oder gleich $n$.

Es gilt sogar:
\begin{Leme}\label{7.2.1}
  Zu $n+1$ paarweise verschiedenen Knoten $x_0,\dots, x_n$
gibt es genau eine Quadraturformel
\begin{gather*}
  \hat{I}(f) = \sum_{i=0}^nw_if(x_i)
\end{gather*}
mit $w_i\in\R$, welche für alle Polynome $p\in\mathcal{P}_n$ exakt ist.

\begin{proof}
  $L_i\in\mathcal{P}_n$, also 
  \begin{align*}
    I(L_i)=\hat{I}(L_i)&=\sum_{j=0}^{n}w_jL_i(x_j)\\
                       &=\sum_{j=0}^{n}w_j\delta_{ij}\\
                       &=w_i && \text{für } i=0,\dots,n
  \end{align*}
  Die Gewichte sind damit eindeutig bestimmt.
\end{proof}
\end{Leme}

\begin{Defe}\label{7.2.2}
  $\hat{I}$ heißt \textbf{abgeschlossene Quadraturformel}
  \index{Quadraturformel!abgeschlossen},
  falls $a=x_0$ und $b=x_n$.
  $\hat{I}$ heißt \textbf{offen}, falls $a<x_0$ und $x_n<b$.\\
  ($\hat{I}_M$ ist also eine offene Quadraturformel.)
\end{Defe}

\subsectione{Newton-Cotes-Formeln}
Abgeschlossene, interpolatorische Quadraturformeln mit
äquidistanter Stützstellenverteilung $x_0, \dots, x_n$ heißen
\textbf{Newton-Cotes-Formeln der Ordnung $n$}.
Mit $h=\frac{b-a}{n}$, $x_i=a+i\cdot h$ und Substitution
$z\coloneqq \frac{t-a}{h}$ gilt
\begin{gather}
  w_i\coloneqq h
  \cdot \int_0^n \prod_{\substack{j=0\\j\neq i}}^n\frac{z-j}{i-j}dz\, .
  \label{VII.2.3}
\end{gather}
Diese sind unabhängig von der Lage der Stützstellen
und liegen in Form von
\begin{gather*}
  w_i=\frac{b-a}{n\cdot s}\sigma_i
\end{gather*}
tabellarisch vor.  Es gilt $n\cdot s$, $\sigma_i\in\Z$ und
\begin{gather}
  \hat{I}_n(f) = \frac{(b-a)}{n\cdot s}
  \cdot \sum_{i=0}^{n}\sigma_i f(x_i)\,.
  \label{VII.2.4}
\end{gather}
Da sie exakt sind für $p\in \mathcal{P}_n$,
können $\frac{\sigma_i}{n\cdot s}$ z.B. aus dem
linearen Gleichungssystem für $[a,b]=[0,1]$
\begin{gather*}
  \int_0^1x^kdx=\frac{1}{n\cdot s}\sum_{i=0}^{n}\sigma_ix_i^k
  \qquad \text{für } k=0,\dots,n
\end{gather*}

\subsectione{Tabelle (Newton-Cotes-Gewichte)}
\begin{align*}
  \begin{array}{ccccccc}
    n\backslash \sigma_i &\sigma_1&\dots&&&& n\cdot s\\
    1 & 1&1&&&&2\\
    2&1&4&1&&&6 \\
    3&1&3&3&1&&8\\
    4&7&32&12&32&7&90\\
    \vdots\\
    8&&&\dots &-4540&\dots
  \end{array}
\end{align*}
Positive Funktionen haben kein positives Integral ab einem $n_0$!!


\nocite{*} %include all books in .bib into bibliography
% ------------------------------------------------------------------
% BACKMATTER
% ------------------------------------------------------------------
\backmatter		% part for index etc.


\printindex		% with package makeidx
% \listoffigures		
% \listoftables

\printbibliography	%only with package biblatex


\end{document}
% ******************************************************************