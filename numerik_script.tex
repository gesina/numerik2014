\documentclass[ngerman,fontsize=11pt, paper=a4, parskip=half, titlepage=true, toc=bib]{scrbook}
%	parskip: 	false sets to 1em
%	titlepage:	titlepage (true) or titlehead (false)
%	toc:		table of contents options
% 
% ESSENTIAL PACKAGES
% ---------------------------------------------------------------------------
%% encodings
\usepackage[T1]{fontenc}      %font-encoding WITH e.g. ö (default is OT1 with 7- instead of 8-bit)
\usepackage[utf8]{inputenc}   %input-encoding WITH e.g. ö (depends on system), better after fontenc
% ..................................................
%% language
\usepackage{babel}	       %rules typical for chosen language(s)
% ..................................................
%% font-settings
\usepackage{lmodern}	       %font: latin modern
\usepackage{microtype}	       %micro-typographic optimizing, e.g. ligatures
% 
% EXTRA PACKAGES
% ----------------------------------------------------------------------------
%% pagestyle
\usepackage{scrpage2}		%KOMA pagestyles scrheadings, scrplain
% \usepackage{enumitem}		% numeration items like \alpha*)
\usepackage{enumerate}		% easy numeration
% ..................................................
%% quotes
\usepackage{csquotes}		%easy quotes with \enquote{...}
% ..................................................
%% maths
\usepackage{amsmath}		%improves maths-sections
\usepackage{mathtools}          %provides tools like \DeclareParedDelimiter or \DefineMathOperator
\usepackage{amsthm}		%for proofs etc.
\usepackage{amssymb}		%further maths symbols like \square for proofs
\usepackage{dsfont}		%for \mathds{letter} to create e.g. the rational numbers symbol Q
\usepackage{stmaryrd}		%for math symbols like lightning bold
\usepackage{MnSymbol}
% \usepackage{bm}		% nicer bold math symbols with \boldsymbol
% \usepackage{siunitx}		%units
% ..................................................
%% colors
% \usepackage{color}		%to set/define colors,
% predefined: white , black, red, green, blue, cyan, magenta, yellow
% ..................................................
%% objects
\usepackage{wrapfig,graphicx}	%inclusion of graphics with \includegraphics{name}
\usepackage{tikz,pgf}
\usetikzlibrary{arrows}
\usetikzlibrary{matrix}
\usetikzlibrary{decorations.pathmorphing}
\usepackage{framed}
% ..................................................
%% index/bibliography
\usepackage{makeidx}		%create an index with \makeindex in head
% (creates *.idx file)
\makeindex			%if index is required (after {makeidx})
\usepackage[backend=biber,style=alphabetic]{biblatex}	% print bibliography with \printbibliography
\bibliography{numerik_script.bib} % loads .bib-file for
% biber-bibliography; after {biblatex}
% ..................................................
%% (nicer)tables
\usepackage{booktabs} 		%enables better spacing and lines in tables
% \usepackage{multirow}	%option multirow for tables (centers text vertically)
% \usepackage{tabulary}	%table-width matches content
% ..................................................
%% font
\usepackage{ulem}         % strike text out
% ..................................................
%% hyperlinks
\usepackage{hyperref}	%for links/hyperlinks, better load last!
% options: colorlink=true (-> no boxes but colored hyperlinks), color of all link
% ..................................................
%% fonts
% \usepackage{anyfontsize}	%any fontsize with \fontsize{size}{baselineskip}\selectfont
 \usepackage{tabularx}  %table with extendable X-column

% DEFINITIONS
% ------------------------------------------------------------------------------------------------
% math (theorems)
\theoremstyle{definition}
\newtheorem{Def}{Definition}[section]		%definition with \begin{Def}
\newtheorem{Bsp}[Def]{Beispiel}
% \theoremstyle{remark}
\newtheorem{Bem}[Def]{Bemerkung}	%corollary with \begin{Korr}
\newtheorem{Wdh}[Def]{Wiederholung}
\theoremstyle{plain}
\newtheorem{Satz}[Def]{Satz}		%theorem with \begin{Satz}
\newtheorem*{satz}{Satz}
\newtheorem{Lem}[Def]{Lemma}		%lemma with \begin{Lem}
\newtheorem{Kor}[Def]{Korollar}		%theorem with \begin{Satz}
\newtheorem{Fol}[Def]{Folgerung}
% \newtheorem{Ax}[Def]{Axiom}		%axiom with \begin{Ax}
% \newtheorem{Prop}[Def]{Proposition}%proposition with \begin{Prop}

% colors
% \definecolor{ashgrey}{rgb}{0.7, 0.75, 0.71}

% NEW COMMANDS
% ------------------------------------------------------------------------------------------------
% symbols
\newcommand{\R}{\mathds{R}}
\newcommand{\Ren}{\mathds{R}^{n}}
\newcommand{\Renn}{\mathds{R}^{n\times n}}
\newcommand{\Renm}{\mathds{R}^{n\times m}}
\newcommand{\Q}{\mathds{Q}}
\newcommand{\N}{\mathds{N}}
\newcommand{\Z}{\mathds{Z}}
\newcommand{\F}{\mathds{F}}
\newcommand{\K}{\mathcal{K}}

% for the three boxes to show float numbers
\newcommand{\floatbox}[3]{ %
  \begin{array}{|c|c|c|}
    \cline{1-3} 	
    #1 & #2 & #3\\
    \cline{1-3}
  \end{array}
}

\newcommand{\nn}[1]{\left\| #1 \right\|}	% norm
\newcommand{\scp}[2]{\langle #1, #2 \rangle}	% scalar prod. 

% inserted sections a), b)
\newcommand{\extrasection}[2]{\vspace{1.5eM}\minisec{\Large\itshape \thesection #1 #2}\vspace{1eM}}

% EVIL HACKS to go along with numeration
% equation numeration
\newcommand{\sectione}[1]{ \setcounter{equation}{0}\section{#1}}
% theorem numeration
\newcommand{\subsectione}[1]{\addtocounter{Def}{1}\subsection{#1}}
\newenvironment{Satze}[1][]{ %
  \begin{Satz}[#1]  }
  { \end{Satz}
  	\addtocounter{subsection}{1}}
\newenvironment{Leme}[1][]{ %
  \begin{Lem}[#1] }
  {\end{Lem}
  	\addtocounter{subsection}{1}}
\newenvironment{Kore}[1][]{ %
  \begin{Kor}[#1]}
  {\end{Kor}
  	\addtocounter{subsection}{1}}
\newenvironment{Fole}[1][]{ %
  \begin{Fol}[#1]}
  {\end{Fol}
  	\addtocounter{subsection}{1}}
\newenvironment{Bspe}[1][]{ %
  \begin{Bsp}[#1]}
  {\end{Bsp}
  	\addtocounter{subsection}{1}}
\newenvironment{Beme}[1][]{ %
  \begin{Bem}[#1]}
  {\end{Bem}
  	\addtocounter{subsection}{1}}
\newenvironment{Defe}[1][]{ %
  \begin{Def}[#1]}
  {\end{Def}
  	\addtocounter{subsection}{1}}
\newenvironment{Wdhe}[1][]{ %
  \begin{Wdh}[#1]}
  {\end{Wdh}
  	\addtocounter{subsection}{1}}
  
% Pseudocode
\newenvironment{pseudocode}[1]{ %
  \begin{minipage}{#1}
    \begin{framed}
      \hspace*{1em}	
      \begin{minipage}{#1}
        \begin{tabbing}
          for~~\= for~~\= for~~\= for~~\= \kill
	}
	{ %
        \end{tabbing}
      \end{minipage}
      \hspace*{1em}
    \end{framed}
  \end{minipage}
}

% missing images
\newcommand{\imagemissing}[1]{
  \begin{center}~\\
    \centering 
    \includegraphics[width=2cm]{images/image_missing.jpg}\\
    \textit{#1} \\
  \end{center}
}	


% STYLE SETTINGS
% ------------------------------------------------------------------------------------------------
% \pagestyle{scrplain}				%set pagestyle to scrheadings or scrplain (instead of headings or plain)
% \clearscrplain						%clear old style (either scrplain odr scrheadings)
% \cfoot[<text for scrplain>]{<text for scrheadings>}	%any new settings for foots/ headings
% \allowdisplaybreaks              %allow multipage for equations
\renewcommand{\theequation}{\thesection.\arabic{equation}}


% quicken compilation
%\includeonly{chapters/numerik_chap0}


% ************************************************************************************************
\begin{document}

% ----------------------------------------------------------------------------------------------
% FRONTMATTER
% ----------------------------------------------------------------------------------------------
\frontmatter	%for book only, part for title etc.

% TITLE(PAGE)
%	\titlehead{titlehead (free)}
\title{Skript Numerik I}
\subtitle{von Prof. Dr. Luise Blank im WS14/15}
%	\subject{type}
\author{Gesina Schwalbe}
%	\date{date}
%	\extratitle{Schmutztitel}
%	\dedication{Widmung}
%	\thanks{Fußnote}
\maketitle

% ---------------------------------------------------
\tableofcontents

% ----------------------------------------------------------------------------------------------
% CONTENT
% ----------------------------------------------------------------------------------------------
\mainmatter		% part for content

% Kap. 0: Vorwort
\include{chapters/numerik_chap0}

% Kap. 1: Einführung
\include{chapters/numerik_chap1}

% Kap. 2: Lineare Gleichungssysteme: Direkte Methoden
\include{chapters/numerik_chap2}

% Kap. 3: Fehleranalyse
\include{chapters/numerik_chap3}

% Kap. 4: Lineare Gleichungssysteme: Direkte Methoden (Fortsetzung)
\include{chapters/numerik_chap4}

% Kap. 5: Numerische Lösung nichtlinearer Gleichungssysteme
\include{chapters/numerik_chap5}

%% Kap. 6: Interpolation
%\include{chapters/numerik_chap6}


\chapter{Interpolation}

Es seien diskrete Werte $f_i=f(t_i)$ und 
eventuell $f_i^{(j)} = f^{(j)}(t_i)$ 
an den Punkten $t_i$ gegeben (z.B. Messdaten).\\
Gesucht ist nun eine zugehörige Funktion $\varphi$.

Anwendungsfeld solcher Probleme ist z.B. CAD (computer aided
design).

Eine naheliegende Forderung ist die
\textbf{Interpolationseigenschaft}\index{Interpolation!-eigenschaft}
\begin{gather*}
  \varphi^{(j)} (t_i) = f_i^{(j)}\qquad \text{gegeben für alle } i,j ,
\end{gather*}
d.h. $\varphi$ und $f$ sollen an den \textbf{Knoten} oder 
\textbf{Stützstellen}\index{Stützstelle} $t_i$ übereinstimmen.
Die $f_i^{(j)}$ heißen Stützwerte\index{Stützwert}.
\imagemissing{Verschiedene Grafen zu Stützstellen-Stützwert-Paaren}
$\varphi$ soll zusätzlich meist leicht an einer beliebigen Stelle $t$
auswertbar sein. \\
Es bietet sich z.B. an 
\begin{itemize}
\item Polynome: $\varphi(t) = a_0+\dots +a_n t^n$
\item rationale Funktion: $\varphi(t) = \frac{p(t)}{q(t)} $\\
  (insbesondere, falls Pole vorliegen)
\item Spline, d.h. stückweise Polynome
\item trigonometrische Funktionen, Fouriertransformationen:\\
  $ \varphi (t) = \sum_{j=1}^{\infty} a_je^{-2\pi ijt}$\\
  (insbesondere für periodische Funktionen)
\end{itemize}

\sectione{Polynom-Iterpolation}
Wir definieren als 
\begin{gather}
  \mathcal{P}_n \coloneqq \left\{ p \in \R[x]\,\middle\vert\,
    p= \sum_{i=0}^{n} a_ix^i \text{ mit } a_i\in\R \right\}
  \label{VI.1.1}
\end{gather}
den Raum aller Polynome\index{Polynomraum} mit $deg(p)\leq n$.\\
Die Monome $1,x, \dots , x^n$ bilden eine Basis von $\mathcal{P}_n$
und es gilt $dim\mathcal{P}_n = n+1$.

\extrasection{a)}{Lagrangesche Interpolationsformel und Lemma von Aitken}

% \subsectione{Satz}
\begin{Satze}\label{6.1.1}
  Zu beliebigen $n+1$ Stützpunkten $(x_i, f_i)_{i=0, \dots n}$ 
  mit $x_i\neq x_k$ für $i\neq k$,
  gibt es genau ein $p\in \mathcal{P}$ mit $p(x_i) = f_i$ für $i=0,
  \dots ,n$.\\
  $p$ heißt \textbf{Interpolationspolynom}\index{Interpolation!-polynom}
  und wird mit $p(f|x_0, \dots, x_n) $ bezeichnet.
\end{Satze}

\begin{proof}~
  \begin{enumerate}[a)]
  \item \textit{Eindeutigkeit}:
    Seien $p_1, p_2\in \mathcal{P}_n$ mit $p_1(x_i)=p_2(x_i) = f_i$
    für $i=0, \dots, n$.
    Dann ist $p\coloneqq p_1-p_2 \in\mathcal{P}_n$
    mit mindestens $n+1$ Nullstellen. \\
    Daraus folgt bereits, dass $p\equiv 0$, also $p_1\equiv p_2$.

  \item \textit{Existenz}: 
    Betrachte die Polynome $L_i\in\mathcal{P}_n$ für $i=0, \dots, n$
    mit 
    \begin{gather}
      L_i(x_k) = \delta_{ik}\quad \text{für } i,k=0, \dots, n 
      \label{VI.1.2}
    \end{gather}
    Diese sind gegeben durch
    \begin{gather}
      L_i(x) \coloneqq \frac{(x-x_0)\cdot \dotsc
        \cdot (x-x_{i-1})(x-x_{i+i}) \cdot \dotsc
        \cdot (x-x_n)}
      {(x_i-x_0)\cdot \dots
        \cdot (x_i-x_{i-1})(x_i-x_{i+i}) \cdot \dotsc
        \cdot (x_i-x_n)}
      \label{VI.1.3}
    \end{gather}
    und sind nach a) eindeutig. \\
    Sie heißen \textbf{Lagrange-Polynome}\index{Lagrange-Polynome}.
  \end{enumerate}
  Die \textbf{Lagrange-Interpolationsformel}\index{Interpolation!Lagrange-Formel}
  \begin{gather}
    p(x) = \sum_{i=0}^{n} f_iL_i(x)
    \label{VI.1.4}
  \end{gather}
  bestimmt somit $p(f\,|\,x_0, \dots, x_n)$,
  da $p\in\mathcal{P}_n$ und $p(x_i) = f_i$ für $i=0,\dots, n$.
\end{proof}

Mit \eqref{VI.1.4} folgt weiterhin
\begin{enumerate}[a)]
\item $p$ hängt linear von den Stützwerten $f_i$ ab.
\item Die Lagrange-Polynome bilden eine Basis des $\mathcal{P}_n$.
\end{enumerate}

Die Lagrange-Interpolationsformel ist,
wenn auch für theoretische Fragen günstig,
für praktische Zwecke zu rechenaufwändig.

Zur Auswertung des Interpolationspolynoms $p(f\,|\,x_0,\dots, x_n)$
an einer festen Stelle $\overline{x}$, d.h.
um den Wert $p(\overline{x} ) $ zu berechnen,
benötigt man:

% \subsectione{Lemma von Aitken}
\begin{Leme}[Lemma von Aitken]\index{Lemma von Aitken}
  Für das Interpolationspolynom $p(f\,|\,x_0, \dots, x_n)$ gilt die 
  Rekursionsformel
  \begin{gather}
    p(f\,|\,x_0, \dots, x_n) (x) = \frac{(x_0-x)p(f\,|\,x_1,\dots, x_n)(x) -
      (x_n-x)p(f\,|\,x_0,\dots, x_{n-1})(x)}
    {(x_0-x_n)}
    \label{VI.1.5}
  \end{gather}
  für $n>0$.	
\end{Leme}

\begin{proof}
  Sei die rechte Seite von \eqref{VI.1.5} definiert als $\varphi(x)$.
  Dann ist $\varphi\in\mathcal{P}_n$ und 
  \begin{alignat*}{3}
    \varphi(x_i) &= \frac{(x_0-x_i)f_i-(x_n-x_i)f_i}{x_0-x_n}= f_i\quad
    &&&\text{für } i&=1,\dots , n-1\\
    \varphi(x_0) &= \frac{0-(x_n-x_0)f_0}{x_0-x_n} = f_0
    &&&\text{für } i&=0\\
    \varphi(x_n) &= \frac{(x_0-x_n)f_n-0}{x_0-x_n} = f_n
    &&&\text{für } i&=n\\
  \end{alignat*}
  Damit ist $p(f\,|\,x_0, \dots, x_n) = \varphi$ aufgrund der Eindeutigkeit.
\end{proof}


%-----------------------------------------------------------------------

Weiterhin gilt
\marginpar{03.12.2014}
\begin{gather}
  p(f\,|\, x_i)(x) = f_i\quad \forall x\in\R
  \label{VI.1.6}
\end{gather}
Definiere nun für ein festes $\overline{x}$
\begin{gather}
  P_{ik} \coloneqq p(f\,|\, x_{i-k}, \dots, x_{i})(\overline{x})
  \label{VI.1.7}
\end{gather}
Dann lässt sich der Wert
\begin{gather*}
  p(\overline{x}) = p(f\,|\, x_0, \dots , x_n)(\overline{x})= P_{nn}
\end{gather*}
nach \eqref{VI.1.5} wie folgt berechnen:


\subsectione{Schema von Neville}
\index{Neville-Schema}
Setze $P_{i0} = f_i$ für $i=0, \dots , n$ und
\begin{gather}
  P_{ik} = P_{i,k-1}+\frac{\overline{x}-x_i}{x_i-x_{i-k}}
  \cdot \left( P_{i,k-1}-P_{i-1,k-1}\right)
  \quad \text{für } 1\leq k\leq i\leq n
  \label{VI.1.8}
\end{gather}
\begin{gather*}
  \begin{array}{r|cccccccccc}
    x_i\backslash k & 0 && 1 && \dots \\
    \cline{1-8}
    x_0 & f_0 & \searrow\\
    x_1 & f_1 & \rightarrow & P_{11}&\searrow\\
    \vdots & \vdots && P_{21} &\rightarrow& P_{22} \\
    \vdots  & \vdots && && &\ddots \\
    x_n & f_n && P_{n1} && \dots &&  P_{nn}
  \end{array}
\end{gather*}
\eqref{VI.1.8} benötigt weniger Multiplikationen als 
\eqref{VI.1.5} und ist deutlich billiger als
\eqref{VI.1.4}.
Pro Auswertung an einer Stelle $\overline{x}$ sind
$\frac{n(n+1)}{2}$ Multiplikationen und Divisionen notwendig.\\
Soll das Interpolationspolynom an mehreren Stellen ausgewertet werden,
ist das Schema von Neville zu teuer.

\extrasection{b)}{Newtonsche Interpolationsformel}
Betrachte folgende Basisdarstellung eines Polynoms $p\in\mathcal{P}_n$
\begin{align}
  p(x) = \sum_{i=0}^{n}a_i \prod_{j=0}^{i-1} (x-x_j)
  \label{VI.1.9}
\end{align} 
Damit wird $p$ zu 
\begin{gather}
  p(x)= \Bigg(\dots \bigg(\Big(
  \big(a_n(x-x_{n-1})+a_{n-1}\big)\cdot(x-x_{n-2})+a_{n-2}\Big)
  \cdot (x-x_{n-3})+a_{n-3}\bigg) \dots\dots\Bigg)
  \label{VI.1.10}
\end{gather}
Es ergibt sich für bekannte $a_i\in\R$:

\subsectione{Das Horner-Schema zur Auswertung p(x)}
\index{Horner-Schema}
\begin{pseudocode}{6cm}
  $p=a_n$ \\
  \textbf{for} $k=n-1:-1:0$\\
  |\>  $p=p(x-x_k)+a_k$\\
  \textbf{end}
\end{pseudocode}

Pro Auswertung benötigt es $n$ Multiplikationen.\\
Zur Bestimmung der notwendigen Koeffizienten $a_0, \dots, a_n$
von $p(f\,|\, x_0, \dots , x_n)$ kann folgende 
Vorwärtssubstitution verwendet werden
\begin{align*}
  f_0 &= p(x_0) = a_0\\
  f_1 &= p(x_1) = a_0+a_1(x_1-x_0)\\
      &\vdots\\
  f_n &=p(x_n) = a_0 + \dots + a_n(x_n-x_0)\cdot\dots\cdot(x_n-x_{n-1})
\end{align*}
Es geht jedoch noch billiger, wie gleich zu sehen ist.

\begin{Defe}~
  \begin{enumerate}[a)]
  \item Die folgenden Polynome heißen \textbf{Newton-Polynome}
    \index{Newton-Polynome}
    \begin{align*}
      w_0(x) &\coloneqq 1\\
      w_i(x) &\coloneqq \prod_{j=0}^{i-1} (x-x_j)
             &\text{für } i\geq 1
    \end{align*}
  \item Die $n$-te dividierte Differenz $[x_0,\dots , x_n]f$
  	\index{dividierte Differenzen}
    ist definiert durch
    \begin{align}\nonumber
      [x_i]f &\coloneqq f_i\\
      [x_i,\dots, x_n]f 
             &\coloneqq
               \frac{[x_{i+1},\dots,x_n]f-[x_i,\dots,x_{n-1}]f}
               {x_n-x_i}
       \label{VI.1.11}
    \end{align}
    für $x_n\neq x_i$.
  \end{enumerate}
\end{Defe}


\begin{Satze}\label{6.1.6}
  Sei $p(f\,|\, x_0,\dots ,x_n)(x)=\sum_{i=0}^{n}a_iw_i(x) = 
  a_nx^n+ \sum_{i=0}^{n-1}c_ix^i$, dann gilt
  \begin{gather*}
    a_n= [x_0, \dots, x_n]f
  \end{gather*}
  und für jede Permutation $\sigma \in S_n$
  \begin{gather*}
	 [x_0,\dots, x_n]f= [x_{\sigma(0)},\dots , x_{\sigma(n)}]f
  \end{gather*}
  Somit ist $[x_0, \dots, x_n]f$ wie p unabhängig von der
  Reihenfolge der Knoten und es gilt für $x_l\neq x_j$
  \begin{gather}
    [x_i, \dots, x_k] f= \frac{[x_i,\dots,\widehat{x}_j,\dots,x_k]f
      -[x_i,\dots,\widehat{x}_l,\dots,x_k]f}
    {x_l-x_j}
    \label{VI.1.12}
  \end{gather}
  wobei $\widehat{\,\cdot\,}$ bedeutet, dass dieser Knoten
  weggelassen wird.
\end{Satze}

\begin{proof}
  Wir zeigen den Satz per Induktion.\\
  Induktionsanfang mit $n=0$:
  \begin{gather*}
    p(f\,|\,x_0) (x) = f_0 = a_0 = [x_0]f
  \end{gather*}
  Induktionsschritt $n \rightarrow n+1$:
  Nach dem Lemma von Aitken gilt \eqref{VI.1.5}, also 
  \begin{gather*}
    p(f\,|\,x_0, \dots, x_{n+1}) (x) 
    = \frac{(x_0-{\boldsymbol x}){\boldsymbol p}(f\,|\,x_1,\dots, x_{n+1})(x) -
      (x_{n+1}-{\boldsymbol x}){\boldsymbol p}(f\,|\,x_0,\dots, x_{n})(x)}
    {(x_0-x_{n+1})}
  \end{gather*}
  Nach Induktionsvoraussetzung gilt also 
  für den Koeffizienten zu  $x^{n+1}$, welcher $a_{n+1}$ ist,
  \begin{align*}
    a_{n+1} &= \frac{-[x_1,\dots, x_{n+1}]f+[x_0,\dots,x_n]f}
              {x_0-x_{n+1}}\\
            & = [x_0, \dots , x_{n+1}] f
  \end{align*}
\end{proof}


\begin{Satze}[Newtonsche Darstellung]\label{6.1.7}
 \index{Polynomraum!Newtonsche Darstellung}
  Es gilt 
  \begin{gather}
    p(f\,|\, x_0, \dots , x_n)(x) 
    = \sum_{i=0}^{n}[x_0,\dots, x_i]f\cdot w_i(x)
    \label{VI.1.13}
  \end{gather}
  und $\left\{w_k\middle\vert k\in \{0,\dots,n\}\right\}$
  bildet Basis von $\mathcal{P}_n$.
\end{Satze}

\begin{proof}
	Wir zeigen \eqref{VI.1.10} per Induktion.\\
  $n=0$ ist klar.\\
  $n-1\rightarrow n$: Sei $p_n(x)\coloneqq p(f\,|\, x_0,\dots,x_n)(x)
  = [x_0,\dots, x_n]f \cdot w_n(x) + q_{n-1}(x)$ mit
  $q_{n-1}\in\mathcal{P}_{n-1}$ und $q_{n-1}(x_i)=p_{n-1}(x_i)=f_i$
  für $i=0,\dots ,n-1$, da $w_n(x_i)=0$.\\
  Damit folgt
  \begin{gather*}
    q_{n-1} = p(f\,|\,x_0, \dots, x_{n-1})
    =\sum_{i=0}^{n-1}[x_0,\dots, x_i]f\cdot w_i(x)
  \end{gather*}
  nach Induktionsvoraussetzung. 
  Es folgt Gleichung  \eqref{VI.1.13}.\\
  $\left\{w_0, \dots,w_n\right\}$ sind linear unabhängig
  und jedes Polynom $\varphi\in\mathcal{P}_n$
  lässt sich wegen $q(x)=p(q\,|\,x_0,\dots,x_n)(x)$
  durch \eqref{VI.1.13} darstellen.
\end{proof}

Entsprechend zum Schema von Neville für $p(\overline{x})$
ergibt sich zur Berechnung der Koeffizienten $a_i=[x_0,\dots,x_i]f$
in \eqref{VI.1.10} folgendes Schema:

\subsectione{Das Schema der dividierten Differenzen}
\index{dividierte Differenzen!Schema}
 \begin{gather*}
   \begin{array}{ccccccccc}
          x_0 & \boldsymbol{f_0=[x_0]f} & \searrow\\
          x_1 & f_1=[x_1]f& \rightarrow &\boldsymbol{ [x_0,x_1]f}&\searrow \\
          \vdots&\vdots &&\vdots &\rightarrow & \boldsymbol{[x_0,x_1,x_2]f}\\
          \vdots&\vdots &&\vdots &&\vdots&\ddots\\
          x_n& f_n=[x_n]f &\rightarrow&[x_{n-1},x_n]f&\rightarrow &
          \dots &\rightarrow && \boldsymbol{[x_0,\dots,x_n]f}
   \end{array}
 \end{gather*}
(markiert sind die benötigten Werte)\\
Der Aufwand zur Berechnung aller Koeffizienten $a_i$ beträgt
\begin{gather*}
  \frac{n(n+1)}{2} ~\text{Divisionen}
\end{gather*}
Kombiniert mit dem Horner-Schema ergibt sich
zur Auswertung von $p$ an $m$ Stellen ein Aufwand von
\begin{gather*}
  \frac{n(n+1)}{2} ~\text{Divisionen}
  ~+m\cdot n   ~\text{Multiplikationen}
\end{gather*}
Das Schema von Neville benötigt dagegen
\begin{gather*}
  m\cdot\frac{n(n+1)}{2} ~\text{Multiplikationene und Divisionen}
\end{gather*}

\begin{Beme}
  Da $p(f\,|\, x_0,\dots, x_n)$ linear von den Stützwerten $f_i$
  abhängt,
  d.h. $p(\alpha f+\beta g\,|\, x_0,\dots, x_n)= 
  \alpha p(f\,|\, x_0,\dots, x_n)+\beta p(g\,|\, x_0,\dots, x_n)$
  gilt, folgt somit auch
  \begin{gather*}
    [x_i,\dots, x_k](\alpha f+\beta g)
    =  \alpha [x_i,\dots, x_k]f+\beta [x_i,\dots, x_k]g 
  \end{gather*}
\end{Beme}


\begin{Satze}[Leibnizregel für dividierte Differenzen]\label{6.1.10}
	\index{dividierte Differenzen!Leibnizregel}
  Seien $x_0,\dots, x_n$ paarweise verschieden. Dann gilt
  \begin{gather}
    [x_0,\dots, x_n] (g\cdot h] = \sum_{i=0}^{n}[x_0,\dots,x_i]g[x_i,\dots,x_n]h
    \label{VI.1.14}
  \end{gather}
\end{Satze}


\begin{proof}
  Es seien
  \begin{align*}
    G(x) &\coloneqq \sum_{i=0}^{n} [x_0,\dots,x_i]g\cdot w_i(x)
           = p(g\,|\,x_0,\dots x_n)(x)\\
    H(x) &\coloneqq \sum_{j=0}^{n}[x_j,\dots, x_n]h\cdot\widetilde{w}_j(x)
           =p(h\,|\,x_n,\dots,x_0)(x)
  \end{align*}
  mit $\widetilde{w}_j(x) =
  \prod_{l=j+1}^{n}(x-x_l)\in\mathcal{P}_{n-j}$.\\
  Dann folgt 
  \begin{align*}
    (G\cdot H)(x_i) &= g(x_i)g(x_i) \quad \forall i\leq n
                      \intertext{und}
                      G\cdot H &= \sum_{i,j=0}^{n}[x_0,\dots,x_i]g\cdot
                                 [x_j,\dots,x_n]h\cdot w_i\widetilde{w}_j
                                 \in\mathcal{P}_{2n}
  \end{align*}
  Wegen 
  \begin{gather*}
    w_i(x_k)\widetilde{w}_j(x_k) = \prod_{l=0}^{i-1}(x_k-x_l)
    \prod_{l=j+1}^{n}(x_k-x_l) = 0
  \end{gather*}
  für alle $k$, falls $i\geq j+1$, interpoliert auch 
  \begin{gather*}
    P\coloneqq \sum_{0\leq i\leq j\leq n}[x_0,\dots, x_i]g
    \cdot [x_j,\dots, x_n]h
    \underbrace{w_i\widetilde{w}_jj}_{\in\mathcal{P}_{n+i-j}}
    \in\mathcal{P}_n
  \end{gather*}
  die Werte $g(x_k),h(x_k)$ für $k=0,\dots,n$
  und es gilt $P\in\mathcal{P}_n$.\\
  Aufgrund der Eindeutigkeit gilt
  \begin{gather*}
    p(g\cdot h\,|\, x_0,\dots, x_n) = P 
    = \sum_{i=0}^{n}[x_0,\dots, x_i]g\cdot [x_i,\dots,x_n]h\cdot x^n
    + \sum_{l=0}^{n-1}c_lx^l
  \end{gather*}
  und Gleichung \eqref{VI.1.14} folgt.
\end{proof}


%----------------------------------------------------------------

\extrasection{c)}{Hermite-Interpolation}
\marginpar{08.12.2014}
Gegeben seien die Knoten  $x_0<x_1<\dots <x_m$
und die Werte $ f_i^{(k)}$ für $k=0,\dots, n_i-1$
mit $i=1,\dots, m$.
Dann sind
\begin{gather*}
  n+1\coloneqq \sum_{i=0}^{m} n_i
\end{gather*}
Werte gegeben.

\begin{Defe}\index{Hermite-Interpolationspolynom}
  Ein Polynom $p$ mit $p\in \mathcal{P}_n$
und der Interpolationseigenschaft 
\begin{gather}
  p^{(k)}(x_i) = f_i^{(k)}
\label{VI.1.15}
\end{gather}
für $i=0,\dots m$ und $k=0, \dots , n_i-1$ heißt
\textbf{Hermite-Interpolationspolynom} $p$.
\end{Defe}


\begin{Satze}\label{6.1.12}
  Das Hermite Interpolationspolynom existiert und ist eindeutig.

\begin{proof}~
  \begin{description}
    \item[Eindeutigkeit:] Seien $p_1,p_2\in\mathcal{P}_n$ mit
      \eqref{VI.1.15}, dann gilt $q=p_1-p_2\in\mathcal{P}_n$
      und $q$ hat mit Vielfachheit gezählt mindestens
      $(n+1)$ Nullstellen.\\
      Damit folgt bereits $q\equiv 0$.
\item[Existenz:] Die Existenz kann wie in Satz \ref{6.1.1}
mit verallgemeinerten Lagrangepolynomen gezeigt werden.\\
Alternativ: Für $p(x) = c_0+c_1x+ \dots +c_nx^n$ ergibt sich
mit \eqref{VI.1.15} ein lineares GLS mit $(n+1)$ Unbekannten
und $(n+1)$ Gleichungen.
Da dieses aufgrund der Eindeutigkeit injektiv ist, ist das GLS
nicht singulär und damit existiert für beliebige $f_i^{(k)}$ eine Lösung.
\end{description}
\end{proof}
\end{Satze}


Führe nun virtuelle Knoten ein:
 \begin{gather*}
   \overbrace{\underset{\eqqcolon t_0}{x_0}
     =\dots
     = \underset{\eqqcolon t_{n_0-1}}{x_0}
   }^{n_0}
 <   \overbrace{\underset{\eqqcolon t_{n_0}}{x_1}=\dots
     = \underset{\eqqcolon t_{n_0+n_1-1}}{x_1}}^{n_1}
 <  \overbrace{\underset{\eqqcolon t_{n-n_m+1}}{x_m}=\dots
     = \underset{\eqqcolon t_{n}}{x_m}}^{n_m}
 \end{gather*}
und ersetze die Bedingung \eqref{VI.1.15} durch
\begin{gather}
  p^{(s_j)}(t_j) = f^{(s_j)}(t_j) \quad \text{für } j=0,\dots,n
\label{VI.1.17}
\end{gather}
dann gilt
\begin{gather}
  s_j= \max\left\{ r\in\N\, \middle\vert\, t_j=t_{j-r}\right\}
  \label{VI.1.18}
\end{gather}

\begin{Bspe}\label{VI.1.13}
  \begin{align*}
     \begin{array}{ccccrc}
       x_0=0 & f_0^{(0)} = -1 & f_0^{(1)}= -2 
       && \Rightarrow & n_0=2 \\
       x_1=1 & f_1^{(0)} = 0 &  f_1^{(1)}= 10 & f_1^{(2)}=40               
                      &\Rightarrow & n_1=3 \\
     \end{array}\Longrightarrow n=4 
\end{align*}
\begin{gather*}
    t_0 = t_1 =x_0=0, \quad t_2=t_3=t_4=x_1=1 \\
     \begin{array}{ccccc}
       s_0=0, & s_1=1, & s_2=0, & s_3=1, & s_4=2
     \end{array}
   \end{gather*}
Bezeichne wiederum mit $p(f\,| \, t_0,\dots, t_n)$
das Interpolationspolynom in $\mathcal{P}_n$,
welches \eqref{VI.1.17} erfüllt.
\end{Bspe}

\begin{Leme}[Lemma von Aitken]
\label{6.1.14}\index{Lemma von Aitken}
Es gelten die Formeln
\begin{enumerate}[a)]
\item falls $t_i=\dots = t_{i+k}=x_l$:
  \begin{gather}
    p(f\,|\, t_i,\dots, t_{i+k})(x) 
    = \sum_{r=0}^{k}\frac{f^{(r)}(x_l)}{r}(x-x_l)^r
    \label{VI.1.19}
  \end{gather}
\item falls $t_i<t_{i+k} $:
  \begin{gather}
    p(f\,|\, t_i,\dots, t_{i+k})(x) 
    = \frac{(x-t_i)\cdot p(f\,|\, t_{i+1},\dots, t_{i+k})(x)
            - (x-t_{i+k})\cdot p(f\,|\,t_k,\dots, t_{i+k-1})(x)}
          {t_{i+k}-t_i}
    \label{VI.1.20}
  \end{gather}
\end{enumerate}
\end{Leme}

\begin{proof}
In beiden Fällen wird nachgewiesen, dass die rechte Seite
das zugehörige Hermite-Interpolationsproblem löst.\\
Aufgrund der Eindeutigkeit von $p\in\mathcal{P}_k$
 folgt dann die Behauptung.
\end{proof}


\begin{Defe}\index{dividierte Differenzen!verallgemeinerte Form}
  Die verallgemeinerte \textbf{dividierte Differenz}
ist definiert durch 
\begin{gather*}
  [t_i,\dots, t_{i+1}]f \coloneqq \frac{1}{k!} f^{(k)}(x_l)
\quad \text{für } t_i=\dots = t_{i+1}=x_l
\end{gather*}
und wie in \eqref{VI.1.11} d.h.
\begin{gather*}
  [t_i,\dots, t_{i+k}]f = \frac{[t_{i+1},\dots, t_{i+k}]f
                                - [t_i,\dots,t_{i+k-1}]f}
                              {t_{i+k}-t_i}
\quad \text{für } t_i<t_{i+k}
\end{gather*}
Wie in \ref{6.1.6} und \ref{6.1.7} folgt aus dem \nameref{6.1.14}
die \textbf{Newtonsche-Darstellung} \eqref{VI.1.13}
\begin{gather*}
  p(f\,|\, t_0,\dots, t_{n})(x) = \sum_{i=0}^{n}[t_0,\dots,t_i]f\cdot w_i(x) 
\end{gather*}
mit $w_i(x) =\prod_{j=0}^{i-1}(x-t_j)$.\\
Ebenso folgt die Leibnizformel für $t_0\leq t_1\leq\dots\leq t_n$
sowie $g,h\in C^n(I)$ aufgrund der Stetigkeit
 der dividierten Differenzen bzgl. $t_i$.\\
Letzteres wäre noch zu zeigen.
\end{Defe}


\begin{Bspe}[Fortsetzung]
  \begin{align*}
    \begin{array}{ccccccc}
      &   x_i& [t_i]f & [t_i,t_{i+1}]f &\dots \\
      t_0 &0 & \boldsymbol{-1} \\
      t_1 &0 & -1 & \boldsymbol{-2}\\ 
      t_2 &1 & 0  & 1  &\boldsymbol{3} \\
      t_3 &1 & 0  & 10 &9  &\boldsymbol{6} \\
      t_4 &1 & 0  & 10 &10 &11 & \boldsymbol{5}
    \end{array}\\
  \end{align*}
  Damit folgt für $p$
  \begin{align*}
    p(f\,|\,t_0,\dots, t_4)(x) 
    =& -1\\
	  &-2(x-0)\\
     & +3(x-0)(x-0)\\
     & +6(x-0)(x-0)(x-1)\\
     & +5(x-0)(x-0)(x-1)(x-1)\\
    =&-1-2x+3x^2+6x^2(x-1)+5x^2(x-1)^2
  \end{align*}
\end{Bspe}

\extrasection{d)}{Fehlerabschätzung}
Der Fehler $f(x) -p(x) $ kann nicht abgeschätzt werden,
falls nicht mehr als die Funktionswerte $f_i$ von f bekannt sind.

\begin{Satze}[Fehlerdarstellung mit dividierten Differenzen]
\index{dividierte Differenzen!Fehlerdarstellung}
Es gilt die Fehlerdarstellung für alle $f$
\begin{gather}
  f(\overline{x})-p(f\,|\,t_0,\dots, t_n)(\overline{x}))
  = [t_o,\dots,t_n,\overline{x}]f\cdot w_{n+1}(\overline{x})
  \label{VI.1.22}
\end{gather}
\end{Satze}

\begin{proof}
  \begin{gather*}
    f(\overline{x})= p(f\,|\,t_0,\dots, t_n)(\overline{x})
    = p(f\,|\, t_0,\dots, t_n)(\overline{x}
    + [t_0,\dots, t_n,\overline{x})]f\cdot w_{n+1}(\overline{x})
  \end{gather*}
aufgrund der Newtonschen Darstellung \eqref{VI.1.13}.
\end{proof}


\begin{Satze}[Restglieddarstellung]
\index{Restglieddarstellung}
Sei $f$ $(n+1)$-mal stetig differenzierbar,
so gibt es zu jedem $\overline{x}$ eine Zahl $\zeta(\overline{x})$
aus dem kleinsten Intervall $I$, welches $x_0,\dots, x_m$ enthält,
so dass 
\begin{gather}
  f(\overline{x})-p(f\,|\,t_0,\dots,t_n)(\overline{x})
  = \frac{f^{(n+1)}(\zeta)}{(n+1)!}\cdot w_{n+1}(\overline{x})
\label{VI.1.21}
\end{gather}
\end{Satze}

\begin{proof}
  Sei $\overline{x}\neq x_i$ (sonst trivial)
\imagemissing{Veranschaulichung zur Restglieddarstellung}
\end{proof}





\nocite{*} %include all books in .bib into bibliography

% ------------------------------------------------------------------
% BACKMATTER
% ------------------------------------------------------------------
\backmatter		% part for index etc.


\printindex		% with package makeidx
% \listoffigures		
% \listoftables

\printbibliography	%only with package biblatex


\end{document}
%******************************************************************